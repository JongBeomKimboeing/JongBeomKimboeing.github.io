---
layout: post
title: Statics 3
description: "Statics 3"
modified: 2020-06-26
tags: [Statics]
categories: [Statics]
---

# 1. 통계적 추론

<br>

## 1) 통계적 추론의 정의<br>
-> 표본이 갖고 있는 정보를 분석하여 모수를 추론한다.<br>
-> 모수에 대한 가설의 옳고 그름을 판단한다.<br>
-> 표본으로 전체 모집단의 성질을 추론하므로 오류가 존재한다.(이 부정확도를 반드시 언급해야한다.)<br>
<br>

## 2) 통계적 추론의 구분

1) 모수 추정
-> 모수에 대한 추론 혹은 추론치를 제시한다.
-> 수치화 된 정확도를 제시한다.

2) 가설 검정
-> 모수에 대한 여러 가설들이 적합한지 표본으로 판단한다.

<br>

## 3) 모수 추정의 구분

1) 점추정
-> 추출된 표본으로부터의 모수의 값에 가까울 것이 예상되는 하나의 값을 제시한다.

2) 구간 추정
-> 하나의 값 대신 모수를 포함할 것이 예상되는 적절한 구간을 제시한다.

<br>

## 4) 모평균 점추정
<br>

-> 모집단의 모수인 평균의 추정

<br>

## 5) 구간 추정

1) 신뢰 구간: 
- 추정량의 분포를 이용하여 표본으로부터 모수의 값을 포함하리라 예상되는 구간<br>
   (작은 값(하한), 큰 값(상한))의 형태
   
2) 신뢰 수준:
- 신뢰 구간이 모수를 포함할 확률을 1보다 작은 일정한 수준에서 유지할 때 확률이 신뢰수준<br>
  (신뢰 수준은 90%, 95%, 99% 등으로 정한다)



<br>
<br>
<br>
<br>

# 2. 통계적 가설 검정

<br>
<br>

## 1) 가설 검정의 정의:

모집단의 특성이나 모수에 대한 주장이 있을 때,<br>
이 주장의 옳고 그름을 표본 자료를 이용하여 판단하는 방법이다.<br>
<br>
가설(모수에 대한 주장) -> 통계적 가설 검정(주어진 가설을 표본 자료로부터 얻은 정보를 통해 검토하는 과정)<br>

<br>
<br>


## 2) 귀무가설과 대립가설

1) 귀무 가설(Null hypothesis)
: 기본적인 가설<br>
<br>

2) 대립가설(Alternative hypothesis)
- 자료를 통하여 입증하고자하는 가설
- 비교하고 싶은 가설
  
<br>
<br>
  
  
## 3) 표본 자료에 대한 가설 선택
-> 선택한 가설에 대한 옳고 그름을 표본자료를 통하여 검정한다. 두 가설 중 옳다고 판단할 수 있는 하나의 가설을 선택한다.<br>
<br>

1) 표본 자료가 대립 가설을 지지하면 대립 가설을 채택한다.
2) 표본 자료가 대립 가설을 지지하지 못하면 귀무 가설을 채택한다.

<br>
<br>


## 4) 오류의 종류
<br>

- 1종 오류: 귀무 가설이 참일 떄 귀무 가설을 기각하는 경우
- 2종 오류: 귀무 가설이 거짓일 때 귀무 가설을 채택하는 경우

<br>
<br>

## 5) 오류의 특징
<br>

- 가설 검정은 표본 자료만으로 모집단에 대한 가설을 검토하므로 오류가 존재한다.
- 바람직한 가설 검정은 두 오류를 최소화하는 것이다.
- 두 오류를 동시에 최소화하는 검정은 존재하지 않거나 찾기 어렵다.
- 1종 오류를 범할 확률과 2종 오류를 범할 확률은 반비례 관계이다.

cf) 1종 오류를 범할 때 더 큰 손실이나 비용이 발생하는 경우가 많다.
(자세한 내용 statics 4-3 ppt 참고)

<br>
<br>

## 6) 오류 최소화 방법

1) 전통적인 통계학에서의 검정
2) 1종 오류를 범할 확률을 우선 최소화
3) 2종 오류를 범할 확률을 최소화

<br>
<br>

## 7) 유의 수준(significant level)

- 1종 오류를 범할 확률에 대한 최대 허용 한계 고정값
- 일반적으로 유의수준의 값으로 0.01~0.1 사이의 작은 값을 사용한다.

<br>
<br>
<br>
<br>

# 3. 검정의 종류와 과정

<br>
<br>

## 1) 가설 검정 과정
<br>

1) 가설 검정<br>
2) 표본 자료의 관측<br>
3) 가설 검정에 사용할 통계량 선택(검정 통계량)<br>
4) 관측값 계산<br>
5) 기각역 / 유의 확률 계산<br>
6) 검정 결과 해석 및 가설 채택<br>

<br>
<br>

## 2) 검정 통계량
- 가설 검정에 사용되는 통계량
- 가설 검정의 결과를 결정하는데 이용되는 표본의 함수
- 표본 평균을 관측하여 그 값으로부터 모평균에 대한 가설 검정을 결정할 때 검정 통계량으로 사용한다

<br>
<br>

## 3) 검정을 위한 기준
<br>

1) 기각역
- 표본 평균을 취하는 구간 중에서 귀무가설을 기각하는 구간
- R: 표본 평균 <= c 로 표현 (표본 평균이 c 이하이면 귀무가설을 기각한다고 판단)
- 기각역의 올바른 선택이 검정의 가장 중요한 부분이다.
- 바람직한 기각역은 두 오류를 범할 확률을 최소화하는 것이다.

<br>

2) 유의 확률 (P-value)
- 정의: 포본 자료가 대립 가설을 지지하는 정도를 0과 1사이의 숫자로 나타낸 최소의 유의 수준 값
- 표준 정규분포표를 이용해 P값을 구해야 함
- 유의수준 > P -> 귀무가설을 기각
- 유의수준 < P -> 귀무가설을 기각할 수 없다.

<br>
<br>

## 4) 가설 검정 종류
<br>

1) 이항 검정<br>

- 이항 분포를 이용하여 베르누이 확률 변수의 모수 p에 대한 가설 조사<br>

- 베르누이 값을 가지는 확률 변수의 분포를 판단한다.<br>

<br>

ex) 어떤 동전을 던질 때, 앞면이 나올 확률 p=0.5인 공정한 동전인지 알아보는 검정<br>
    귀무가설: p = 0.5 vs 대립 가설: p != 0.5<br>

<br>
<br>

## 5) 이항 검정 코드 예시 문제

### 문제

이항 검정에 대한 가설을 설정하고, 검정을 해보겠습니다.<br>
후라이드 치킨 종류를 선호하는 후라이드 파(0)와 양념 치킨 종류를 선호하는 양념파(1)가 있습니다.<br>
이 치킨 선호 유형을 베르누이 확률분포로 결정되는 값이라고 가정하겠습니다.<br>
새로 출시한 치킨을 선호하는 비율은 양념파와 후라이드파가 같다고 가정하므로 베르누이 확률분포의 모수는 0.5 입니다.<br>
<br>
새로 출시한 치킨을 선호하는 사람 50명 중 30명이 양념파였을 때,<br>
“새로 출시된 치킨을 선호하는 사람은 양념파이다” 라고 주장할 수 있을까요? <br>
이를 표본을 추출하여 유의수준 0.05를 기준으로 확인해보겠습니다.<br>
<br>
귀무가설 : “새로 출시한 치킨을 선호하는 사람은 치킨 선호 유형과 연관이 없다 : p= 0.5” <br>
vs. 대립가설 : “새로 출시한 치킨을 선호하는 사람은 치킨 선호 유형과 연관이 있다 : p != 0.5”<br>

<br>
<br>

### 코드

- binom_test = sp.stats.binom_test(n_ber, 50)<>
이를 이용하여 가설 검정

```python
import numpy as np
import scipy as sp
from scipy import stats

np.random.seed(seed= 0)

# 표본 추출
random_ber = np.random.binomial(n = 1,p=0.5, size = 50)
print(random_ber)
# 귀무가설의 모수 p = 0.5 를 갖고 베르누이 분포를 따르므로 n = 1으로 두어
# 이를 따르는 표본을 50개 추출하여 random_ber 에 저장해 확인해보겠습니다.
n_ber = np.count_nonzero(random_ber) # np.count_nonzero() 함수는 0이 아닌 값의 개수를 세어 주는 함수
print(n_ber) # 1의 값은 30개이다. 그렇다면 p = 0.6 인가?

# 가설 검정
binom_test = sp.stats.binom_test(n_ber, 50)
print(binom_test) # 결과값인 유의확률이 유의 수준인 0.05 보다 매우 크므로 귀무가설을 기각할 수 없습니다.
# (결과: 0.20263875106454063)

# 결론: 그러므로 새로 출시된 치킨을 선호하는 것은 후라이드파와 양념파에 상관이 없습니다.
# 즉, “새로 출시된 치킨을 선호하는 사람은 양념파이다” 라고 주장할 수 없습니다.
```


## 6) 모평균 가설검정
-> 표본의 크기가 클 때, 모평균이 정규 분포를 따른다는 가정하에 중심 극한 정리에 의해 정규 분포에 근사한다.

<br>
<br>

## 7) 모평균 가설검정 코드 예시문제

### 문제
<br>

"고양이"를 주인공으로 동영상을 촬영하여 올렸을 때,<br>
한 달 동안 구독자 수를 100명 으로 늘릴 수 있다고 합니다. <br>
이 때, 표준편차는 5임을 알고 있다고 가정합니다. <br>
10명을 대상으로 고양이 주인공 동영상의 한 달 구독자 수를 조사하였더니, 평균이 “103.69” 이었다고 합니다.<br>
<br>
고양이 주인공 동영상의 구독자 수의 모평균을 mu라고 하자. <br>
위의 주장은 mu = 100 이므로 가설은 귀무가설 : " mu = 100" vs. 대립가설 : " mu != 100"<br>

<br>

### 코드

- 모평균 가설 검정 함수가 따로 존재하지 않아 정의해 주어야 한다.

```python
import numpy as np
import scipy as sp
from scipy import stats

np.random.seed(seed= 0)

# 표본 추
random_nor = np.random.normal(100, 5, 10)
# 귀무가설의 모수 mu = 100, sigma = 5 를 갖고 정규분포를 따르는 표본을 10개 표본을 추출하여
# random_nor 에 저장해 확인해본다.
print(random_nor)

nor_mean = np.mean(random_nor)
print(nor_mean) # 이를 확인해보니, 103.69가 나왔습니다. 그렇다면 대립가설인 mu != 100 이 맞을까요?

# 모평균 가설 검정 함수 정의
def ztest(stat, mu, sigma): # stat: 검정 통계량, mu: 모평균, sigma: 모표준 편차
    z = (stat.mean()-mu)/(sigma*np.sqrt(len(stat)))
    return (2*(1-sp.stats.norm.cdf(z))) # 유의 확률 출력

mu_test = ztest(random_nor, 100, 10)
print(mu_test)
# 결과값인 유의확률이 0.05 보다 크므로 귀무가설을 기각할 수 없습니다.
# 하지만, 이는 표본의 크기가 매우 작으므로 이러한 결과가 나왔을 수도 있습니다.
# 표본의 크기를 1000으로 높여서 다시 한 번 검정해보고 이에 대한 결과를 확인해보세요!
```





























